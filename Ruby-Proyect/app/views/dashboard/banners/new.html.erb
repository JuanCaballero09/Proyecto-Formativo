<section>
    <h2>Agregar imagen al Banner</h2>

    <%= form_with model: [:dashboard, @banner], local: true, html: { class: "dashboard-form" } do |f| %>
        
        <div class="field">
            <%= f.label :imagen, "Imagen del Banner" %>
            <br>
            <p class="banner-dimensions-info">
                üìê Dimensiones recomendadas: <strong>1920x600 p√≠xeles</strong> (Proporci√≥n 16:5)
            </p>
            <br>
            <%= f.file_field :imagen, accept: "image/*", id: "banner-image-input" %>
        </div>

        <div id="banner-preview-container" style="display: none; margin: 20px 0;">
            <h3>Vista Previa del Banner</h3>
            <div class="banner-preview-wrapper" style="aspect-ratio: 16 / 5; overflow: hidden; border: 2px solid #ddd; border-radius: 8px; position: relative; background: #f5f5f5;">
                <img id="banner-preview" src="" alt="Vista previa" style="width: 100%; height: 100%; object-fit: cover; filter: brightness(0.7);">
            </div>
            <p id="banner-dimensions-display" style="margin-top: 10px; font-size: 14px; color: #666;"></p>
        </div>

        <div>
            <%= f.submit "Subir imagen" %>
            <%= link_to 'Volver', dashboard_banners_path %>
        </div>
    <% end %>
</section>

<style>
.banner-dimensions-info {
    background: #f0f8ff;
    border-left: 4px solid #2196F3;
    padding: 10px 15px;
    margin: 10px 0;
    font-size: 14px;
    color: #333;
}

.banner-preview-wrapper {
    background: #f5f5f5;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
}
</style>

<script>
function initBannerPreview() {
    const imageInput = document.getElementById('banner-image-input');
    const previewContainer = document.getElementById('banner-preview-container');
    const previewImage = document.getElementById('banner-preview');
    
    if (imageInput) {
        imageInput.addEventListener('change', function(e) {
            const file = e.target.files[0];
            
            if (file && file.type.startsWith('image/')) {
                const reader = new FileReader();
                
                reader.onload = function(event) {
                    const img = new Image();
                    
                    img.onload = function() {
                        // Mostrar vista previa
                        previewImage.src = event.target.result;
                        previewContainer.style.display = 'block';
                        
                        // Calcular proporci√≥n
                        const ratio = (img.width / img.height).toFixed(2);
                        const optimalRatio = (16 / 5).toFixed(2);
                        
                        // Mostrar dimensiones
                        let message = `üìè Dimensiones de la imagen: ${img.width} x ${img.height} p√≠xeles (Proporci√≥n ${ratio}:1)`;
                        
                    };
                    
                    img.src = event.target.result;
                };
                
                reader.readAsDataURL(file);
            }
        });
    }
}

// Inicializar en DOMContentLoaded y turbo:load
document.addEventListener('DOMContentLoaded', initBannerPreview);
document.addEventListener('turbo:load', initBannerPreview);
</script>