<section class="producto-show-modern">
  <div class="producto-container">
    <!-- Sidebar con imagen y acciones -->
    <aside class="producto-sidebar">
      <div class="producto-imagen-main">
        <div class="img-wrapper shimmer">
          <div class="img-loader"></div>
          <img
            src="<%= @product.imagen.attached? ? url_for(@product.imagen_resized2) : asset_path('LogoLogoText2.svg') %>"
            alt="<%= @product.nombre %>"
            class="producto-imagen-page"
            onload="imageLoaded(this)"
            onerror="imageError(this)"
          >
          </div>
      </div>

      <div class="producto-precio-card">
        <div class="precio-container">
          <span class="precio-label"><%= t("home.show-vista.precio")%></span>
          <span class="precio-valor">
             <strong class="precio-unitario" data-precio="<%= @product.precio %>" data-locale="<%= I18n.locale %>">$</strong>
          </span>
        </div>
      </div>

      <%# <div class="producto-rating"> %>
        <%# <h3>Calificaci√≥n</h3> %>
        <%# <div class="stars"> %>
          <%# <span class="star filled">‚òÖ</span> %>
          <%# <span class="star filled">‚òÖ</span> %>
          <%# <span class="star filled">‚òÖ</span> %>
          <%# <span class="star filled">‚òÖ</span> %>
          <%# <span class="star">‚òÖ</span> %>
          <%# <span class="rating-number">(4.0)</span> %>
        <%# </div> %>
      <%# </div> %>

      <div class="producto-acciones">
        <%= button_to t("home.carrito.agregar_carrito"), 
                     carrito_items_path(product_id: @product.id), 
                     method: :post, 
                     class: "btn-agregar-modern",
                     data: { turbo_frame: "_top" } %>
      </div>
    </aside>

    <!-- Contenido principal -->
    <main class="producto-contenido">
      <header class="producto-header">
        <h1 class="producto-titulo"><%= @product.nombre %></h1>
        <p class="producto-categoria">
          <span class="categoria-badge"><%= @product.grupo.nombre %></span>
        </p>
      </header>

      <div class="producto-descripcion">
        <h3 class="seccion-titulo">Descripci√≥n</h3>
        <p class="descripcion-texto"><%= @product.descripcion %></p>
      </div>

      <div class="producto-detalles-grid">
        <% if @product.type == "Combo" %>
          <div class="detalle-card">
            <h3 class="card-titulo">
              <span class="icono">üéÅ</span>
              Componentes del combo
            </h3>
            <ul class="ingredientes-lista">
              <% if @product.respond_to?(:combo_items) && @product.combo_items.any? %>
                <% @product.combo_items.includes(:product).each do |combo_item| %>
                  <li class="ingrediente-item">
                    <span class="ingrediente-bullet">‚Ä¢</span>
                    <%= combo_item.cantidad %>x 
                    <%= link_to grupo_product_path(combo_item.product.grupo, combo_item.product),
                                style: "color: var(--base); text-decoration: none; font-weight: 600; font-size: 1.1em; display: inline-flex; align-items: center; gap: 5px;",
                                onmouseover: "this.style.color='var(--base-oscuro)'; this.style.transform='translateX(3px)'; this.style.transition='all 0.2s'",
                                onmouseout: "this.style.color='var(--base)'; this.style.transform='translateX(0)'" do %>
                      <%= combo_item.product.nombre %>
                      <span style="font-size: 1.2em;">üîó</span>
                    <% end %>
                  </li>
                <% end %>
              <% else %>
                <li class="ingrediente-item">
                  <span class="ingrediente-bullet">‚Ä¢</span>
                  Sin componentes definidos
                </li>
              <% end %>
            </ul>
          </div>
        <% else %>
          <% if @product.ingredientes.any? %>
            <div class="detalle-card">
              <h3 class="card-titulo">
                <span class="icono">üåø</span>
                <%= t("home.dashboard.ingredientes")%>
              </h3>
              <ul class="ingredientes-lista">
                <% @product.ingredientes.each do |ingrediente| %>
                  <li class="ingrediente-item">
                    <span class="ingrediente-bullet">‚Ä¢</span>
                    <%= ingrediente.nombre %>
                  </li>
                <% end %>
              </ul>
            </div>
          <% end %>
        <% end %>

        <%# <div class="detalle-card"> %>
          <%# <h3 class="card-titulo"> %>
            <%# <span class="icono">üí¨</span> %>
            <%# <%= t("home.show-vista.opiniones")%>
          <%# </h3> %>
          <%# <div class="opiniones-lista"> %>
            <%# <div class="opinion-item"> %>
              <%# <div class="opinion-texto"><%= t("home.categoria.comentario_uno")%>
              <%# <div class="opinion-autor">‚Äî Ana</div> %>
            <%# </div> %>
            <%# <div class="opinion-item"> %>
              <%# <div class="opinion-texto"><%= t("home.categoria.comentario_dos")%>
              <%# <div class="opinion-autor">‚Äî Luis</div> %>
            <%# </div> %>
          <%# </div> %>
        <%# </div> %>
      </div>
    </main>
  </div>
</section>