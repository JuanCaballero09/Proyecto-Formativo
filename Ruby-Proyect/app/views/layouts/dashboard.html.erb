<!DOCTYPE html>
<html>
<head>
  <title>Panel De Administrador</title>
  <%= csrf_meta_tags %>
  <%= csp_meta_tag %>
  <%= stylesheet_link_tag "application", "data-turbo-track": "reload" %>
  <%= javascript_importmap_tags %>
  <%= action_cable_meta_tag %>

  <style>#alert-container{position:fixed;top:20px;left:50%;transform:translateX(-50%);z-index:9999;display:flex;flex-direction:column;gap:10px;align-items:center;pointer-events:none;}.alert{min-width:280px;max-width:400px;background:white;padding:15px 20px;border-radius:12px;font-weight:bold;color:#333;box-shadow:0 6px 16px rgba(0,0,0,0.25);opacity:0;transform:translateY(-80px);animation:slideDown 0.5s forwards;pointer-events:auto;}.alert.success{border:3px solid #27ae60;background-color:#d4f5e3;color:#145a32;}.alert.error{border:3px solid #c0392b;background-color:#f9d6d5;color:#641e16;}.alert.warning{border:3px solid #e67e22;background-color:#fef3d4;color:#7e5109;}.alert.info{border:3px solid #2196f3;background-color:#e3f2fd;color:#0d47a1;}@keyframes slideDown{to{opacity:1;transform:translateY(0);}}@keyframes slideUp{to{opacity:0;transform:translateY(-80px);}}</style>

  <link rel="icon" href="<%= asset_path('LogoLogo.svg') %>" type="image/svg+xml">
  <link rel="apple-touch-icon" href="<%= asset_path('LogoLogo.svg') %>" type="image/svg+xml">
  
  <%= stylesheet_link_tag "bootstrap.min", "data-turbo-track": "reload" %>
  <%= stylesheet_link_tag "dashboard", "data-turbo-track": "reload" %>

</head>
<body>
  <main class="dashboard-container" style="display: flex;">
  
    <aside class="sidebar">

      <div class="session-header" style="margin: 15px 0; ">
        <%= image_tag "LogoLogo.svg", alt: "logo", style: "margin:0; height: 130px; width:130px;"%>
      </div>

      <h2>Panel</h2>

      <% if current_user.empleado? %>

        <p>Bienvenido, <%= current_user.nombre %>!</p>

        <%= link_to t("home.ordenes.ordenes"), employee_dashboard_orders_path %>
      
      <% elsif current_user.admin? %>
      
        <p>Bienvenido, <%= current_user.nombre %>!</p>

        <%= link_to t("home.dashboard.dash"), dashboard_root_path %>
        <%= link_to t("home.usuarios.usuarios"), dashboard_users_path %>
        <%= link_to t("home.ordenes.ordenes"), dashboard_orders_path %>
        
        <details>
          <summary><%= t("home.dashboard.banner")%></summary>
            <div class="details-content">
              <%= link_to t("home.dashboard.ver_banners"), dashboard_banners_path%>
              <%= link_to t("home.dashboard.crear_banner"), new_dashboard_banner_path%>
            </div>
        </details>

        <details>
          <summary><%= t("home.dashboard.cuponn")%></summary>
            <div class="details-content">
              <%= link_to t("home.dashboard.ver_cupones"), dashboard_coupons_path %>
              <%= link_to t("home.dashboard.crear_cupon"), new_dashboard_coupon_path %>
            </div>
        </details>

        <details>
          <summary><%= t("home.dashboard.producto")%></summary>
            <div class="details-content">
              <%= link_to t("home.dashboard.ver_productos"), dashboard_products_path %>
              <%= link_to t("home.dashboard.crear_producto"), new_dashboard_product_path %>
            </div>
        </details>

        <details>
          <summary><%= t("home.dashboard.grupos")%></summary>
            <div class="details-content">
              <%= link_to t("home.dashboard.ver_grupos"), dashboard_grupos_path %>
              <%= link_to t("home.dashboard.crear_grupo"), new_dashboard_grupo_path %>
            </div>
        </details>

        <details>
          <summary><%= t("home.dashboard.ingredientes")%></summary>
            <div class="details-content">
              <%= link_to t("home.dashboard.ver_ingredientes"), dashboard_ingredientes_path %>
              <%= link_to t("home.dashboard.crear_ingrediente"), new_dashboard_ingrediente_path %>
            </div>
        </details>

      <% end %>

      
      <%= link_to t("home.dashboard.volver_al_inicio"), root_path, class: "sidebar-footer"%>
      
    </aside>


    <section class="main-content">

      <!-- Contenedor de alertas -->
      <div id="alert-container">
        <% flash.each do |key, message| %>
          <% css_class = case key.to_sym
            when :notice then "info"
            when :alert  then "warning"
            when :error  then "error"
            when :success then "success"
            else "info"
          end %>
          <div class="alert <%= css_class %>"><%= message %></div>
        <% end %>
      </div>


      <%= yield %>
      
    </section>

  </main>
  <div id="animations"></div>
  <script>
  document.addEventListener("turbo:load", () => {
    const alerts = document.querySelectorAll("#alert-container .alert");

    alerts.forEach(alert => {
      // Espera 3 segundos
      setTimeout(() => {
        // Activa animación de salida
        alert.style.animation = "slideUp 0.5s forwards";

        // Cuando termine la animación, elimina el elemento
        alert.addEventListener("animationend", () => {
          if (alert.style.animationName === "slideUp") {
            alert.remove();
          }
        });
      }, 3000);
    });
  });
  </script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</body>
</html>
